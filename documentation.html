<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Node.js Database Documentation</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.6; 
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #2563eb; 
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2em;
        }
        h2 { 
            color: #2563eb; 
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        h3 { 
            color: #374151; 
            margin: 25px 0 10px 0;
        }
        p { margin-bottom: 15px; }
        code {
            background: #1e293b;
            color: #e2e8f0;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #2563eb;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #2563eb;
        }
        .alert {
            background: #dbeafe;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #2563eb;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        th {
            background: #f8fafc;
            font-weight: bold;
            color: #374151;
        }
        tr:hover {
            background: #f8fafc;
        }
        .nav {
            background: #1e293b;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .nav a {
            color: white;
            text-decoration: none;
            margin-right: 20px;
        }
        .nav a:hover {
            color: #60a5fa;
        }
        .badge {
            background: #2563eb;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 5px;
        }
        @media (max-width: 768px) {
            body { padding: 10px; }
            .container { padding: 20px; }
            .feature-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Node.js Database</h1>
        <div class="subtitle">High-performance NoSQL Database with HTTP API & WebSocket Support</div>

        <div class="nav">
            <a href="#overview">Overview</a>
            <a href="#installation">Installation</a>
            <a href="#quickstart">Quick Start</a>
            <a href="#api">API Reference</a>
            <a href="#websocket">WebSocket</a>
            <a href="#examples">Examples</a>
        </div>

        <!-- Overview Section -->
        <section id="overview">
            <h2>üìã Overview</h2>
            <p>A feature-rich NoSQL database built entirely in Node.js, designed for modern web applications with real-time requirements.</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>üîß Full CRUD Operations</h3>
                    <p>Complete Create, Read, Update, Delete operations with advanced querying capabilities.</p>
                </div>
                <div class="feature-card">
                    <h3>‚ö° High Performance</h3>
                    <p>Caching, clustering, and optimized queries for maximum throughput.</p>
                </div>
                <div class="feature-card">
                    <h3>üåê HTTP REST API</h3>
                    <p>Standard REST endpoints for all database operations.</p>
                </div>
                <div class="feature-card">
                    <h3>üîî WebSocket Support</h3>
                    <p>Real-time updates and live data synchronization.</p>
                </div>
                <div class="feature-card">
                    <h3>üìä Advanced Querying</h3>
                    <p>MongoDB-like query language with comprehensive operators.</p>
                </div>
                <div class="feature-card">
                    <h3>üíæ Persistent Storage</h3>
                    <p>File-based persistence with automatic data recovery.</p>
                </div>
            </div>

            <div class="alert">
                <strong>Performance Metrics:</strong> 400+ ops/sec throughput, 1ms query response time, 60% cache hit rate, 18MB memory usage.
            </div>
        </section>

        <!-- Installation Section -->
        <section id="installation">
            <h2>üõ† Installation</h2>
            
            <h3>Prerequisites</h3>
            <pre><code>Node.js 16+
npm or yarn
Minimum 512MB RAM
100MB Disk Space</code></pre>

            <h3>Step-by-Step Setup</h3>
            <pre><code># Clone and setup
git clone &lt;repository-url&gt;
cd Database
npm install

# Start the server
npm start

# Development mode (single process)
npm run start:dev

# Production mode (clustered)
npm start -- --port 80 --workers 4 --max-memory 2048</code></pre>

            <div class="alert">
                <strong>Quick Verify:</strong> After starting, visit <code>http://localhost:8080</code> to verify installation.
            </div>
        </section>

        <!-- Quick Start Section -->
        <section id="quickstart">
            <h2>üöÄ Quick Start</h2>
            
            <h3>Basic Usage Example</h3>
            <pre><code>const DBClient = require('./client/DBClient');

async function example() {
  const client = new DBClient('http://localhost:8080');
  
  // Create a collection
  await client.createCollection('users');
  
  // Insert documents
  await client.insert('users', {
    name: 'John Doe',
    email: 'john@example.com',
    age: 30,
    tags: ['admin', 'user']
  });
  
  // Query documents
  const results = await client.find('users', { age: { $gte: 25 } });
  console.log(results);
}

example();</code></pre>

            <h3>Server Configuration</h3>
            <pre><code>const DatabaseServer = require('./server/Server');

const server = new DatabaseServer({
  port: 8080,
  host: 'localhost',
  storagePath: './data',
  cluster: true,
  workers: 4,
  maxMemory: 1024,
  cache: true,
  cacheSize: 1000,
  compression: true
});

server.start().catch(console.error);</code></pre>
        </section>

        <!-- API Reference Section -->
        <section id="api">
            <h2>üì° API Reference</h2>
            
            <h3>Base URL</h3>
            <pre><code>http://localhost:8080</code></pre>

            <h3>Collection Operations</h3>
            
            <h4>List Collections</h4>
            <pre><code>GET /collections

// Response
{
  "collections": ["users", "products", "orders"]
}</code></pre>

            <h4>Create Collection</h4>
            <pre><code>POST /collections
Content-Type: application/json

{
  "name": "users"
}</code></pre>

            <h4>Drop Collection</h4>
            <pre><code>DELETE /collections/users</code></pre>

            <h3>Document Operations</h3>
            
            <h4>Insert Document</h4>
            <pre><code>POST /users
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com",
  "age": 30,
  "tags": ["admin", "user"]
}</code></pre>

            <h4>Find Documents</h4>
            <pre><code>GET /users?query={"age":{"$gte":25}}&options={"limit":10,"sort":{"age":-1}}

// Or using POST for complex queries
POST /users/query
Content-Type: application/json

{
  "query": {
    "age": { "$gte": 25 },
    "status": "active"
  },
  "options": {
    "sort": { "createdAt": -1 },
    "limit": 10,
    "skip": 0
  }
}</code></pre>

            <h4>Update Documents</h4>
            <pre><code>PUT /users
Content-Type: application/json

{
  "query": {
    "status": "inactive"
  },
  "update": {
    "$set": {
      "status": "active",
      "activatedAt": "2024-01-01T00:00:00Z"
    }
  },
  "options": {
    "upsert": false
  }
}</code></pre>

            <h4>Delete Documents</h4>
            <pre><code>DELETE /users
Content-Type: application/json

{
  "query": {
    "status": "inactive"
  }
}</code></pre>

            <h3>Query Operators</h3>
            <table>
                <thead>
                    <tr>
                        <th>Operator</th>
                        <th>Description</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>$eq</code></td>
                        <td>Equal</td>
                        <td><code>{"age": {"$eq": 25}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$ne</code></td>
                        <td>Not equal</td>
                        <td><code>{"status": {"$ne": "inactive"}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$gt</code></td>
                        <td>Greater than</td>
                        <td><code>{"age": {"$gt": 18}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$gte</code></td>
                        <td>Greater than or equal</td>
                        <td><code>{"score": {"$gte": 80}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$lt</code></td>
                        <td>Less than</td>
                        <td><code>{"age": {"$lt": 65}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$lte</code></td>
                        <td>Less than or equal</td>
                        <td><code>{"price": {"$lte": 100}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$in</code></td>
                        <td>In array</td>
                        <td><code>{"category": {"$in": ["tech", "books"]}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$nin</code></td>
                        <td>Not in array</td>
                        <td><code>{"status": {"$nin": ["banned", "inactive"]}}</code></td>
                    </tr>
                    <tr>
                        <td><code>$regex</code></td>
                        <td>Regular expression</td>
                        <td><code>{"name": {"$regex": "^J"}}</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>Logical Operators</h3>
            <pre><code>// AND operator
{
  "$and": [
    { "age": { "$gte": 25 } },
    { "status": "active" },
    { "department": "engineering" }
  ]
}

// OR operator  
{
  "$or": [
    { "status": "active" },
    { "lastLogin": { "$gte": "2024-01-01" } }
  ]
}

// NOR operator
{
  "$nor": [
    { "status": "banned" },
    { "age": { "$lt": 18 } }
  ]
}</code></pre>

            <h3>Aggregation Pipeline</h3>
            <pre><code>POST /users/aggregate
Content-Type: application/json

{
  "pipeline": [
    {
      "$match": {
        "age": { "$gte": 25 }
      }
    },
    {
      "$group": {
        "_id": "$department",
        "count": { "$sum": 1 },
        "averageAge": { "$avg": "$age" },
        "maxAge": { "$max": "$age" },
        "minAge": { "$min": "$age" }
      }
    },
    {
      "$sort": {
        "count": -1
      }
    },
    {
      "$limit": 10
    }
  ]
}</code></pre>

            <h3>Index Operations</h3>
            <pre><code>// Create Index
POST /users/indexes
Content-Type: application/json

{
  "fields": ["email"],
  "options": {
    "unique": true,
    "name": "email_index"
  }
}

// List Indexes
GET /users/indexes

// Drop Index
DELETE /users/indexes/email_index</code></pre>
        </section>

        <!-- WebSocket Section -->
        <section id="websocket">
            <h2>üîå WebSocket API</h2>
            
            <h3>Connection & Subscription</h3>
            <pre><code>const client = new DBClient('http://localhost:8080');

// Connect to WebSocket
await client.connectWebSocket();

// Subscribe to collection changes
await client.subscribe('users');

// Handle real-time events
client.ws.on('message', (data) => {
  const message = JSON.parse(data);
  
  switch(message.type) {
    case 'documentInserted':
      console.log('New document:', message.document);
      break;
      
    case 'documentsUpdated':
      console.log('Documents updated:', message.result);
      break;
      
    case 'documentsDeleted':
      console.log('Documents deleted:', message.result);
      break;
  }
});</code></pre>

            <h3>Real-time Operations</h3>
            <pre><code>// WebSocket find
const results = await client.wsFind('users', { 
  status: 'active' 
});

// WebSocket insert
await client.wsInsert('users', {
  name: 'New User',
  email: 'new@example.com'
});

// WebSocket update  
await client.wsUpdate('users', 
  { email: 'user@example.com' },
  { $set: { status: 'verified' } }
);

// WebSocket delete
await client.wsDelete('users', {
  status: 'inactive'
});</code></pre>

            <h3>Message Types</h3>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Description</th>
                        <th>Data</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>subscribe</code></td>
                        <td>Subscribe to collection</td>
                        <td><code>{ collection }</code></td>
                    </tr>
                    <tr>
                        <td><code>unsubscribe</code></td>
                        <td>Unsubscribe from collection</td>
                        <td><code>{ collection }</code></td>
                    </tr>
                    <tr>
                        <td><code>find</code></td>
                        <td>Query documents</td>
                        <td><code>{ query, options }</code></td>
                    </tr>
                    <tr>
                        <td><code>insert</code></td>
                        <td>Insert document</td>
                        <td><code>{ document }</code></td>
                    </tr>
                    <tr>
                        <td><code>update</code></td>
                        <td>Update documents</td>
                        <td><code>{ query, update, options }</code></td>
                    </tr>
                    <tr>
                        <td><code>delete</code></td>
                        <td>Delete documents</td>
                        <td><code>{ query }</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Examples Section -->
        <section id="examples">
            <h2>üìö Examples</h2>
            
            <h3>E-commerce Application</h3>
            <pre><code>const DBClient = require('./client/DBClient');

class ECommerceDB {
  constructor() {
    this.client = new DBClient('http://localhost:8080');
  }
  
  async initialize() {
    // Create collections
    await this.client.createCollection('users');
    await this.client.createCollection('products');
    await this.client.createCollection('orders');
    
    // Create indexes
    await this.client.createIndex('users', ['email'], { unique: true });
    await this.client.createIndex('products', ['category', 'price']);
    await this.client.createIndex('orders', ['userId', 'createdAt']);
  }
  
  async createUser(userData) {
    return await this.client.insert('users', {
      ...userData,
      createdAt: new Date().toISOString(),
      updatedAt: new Date().toISOString()
    });
  }
  
  async findProducts(category, minPrice, maxPrice) {
    return await this.client.find('products', {
      category: category,
      price: {
        $gte: minPrice,
        $lte: maxPrice
      },
      stock: { $gt: 0 }
    });
  }
  
  async createOrder(orderData) {
    const order = await this.client.insert('orders', {
      ...orderData,
      status: 'pending',
      createdAt: new Date().toISOString(),
      total: orderData.items.reduce((sum, item) => sum + item.price * item.quantity, 0)
    });
    
    // Update product stock
    for (const item of orderData.items) {
      await this.client.update('products', 
        { _id: item.productId },
        { $inc: { stock: -item.quantity } }
      );
    }
    
    return order;
  }
  
  async getSalesReport(startDate, endDate) {
    return await this.client.aggregate('orders', [
      {
        $match: {
          createdAt: {
            $gte: startDate,
            $lte: endDate
          },
          status: 'completed'
        }
      },
      {
        $group: {
          _id: {
            year: { $year: '$createdAt' },
            month: { $month: '$createdAt' },
            day: { $dayOfMonth: '$createdAt' }
          },
          totalSales: { $sum: '$total' },
          orderCount: { $sum: 1 },
          averageOrder: { $avg: '$total' }
        }
      },
      {
        $sort: {
          '_id.year': 1,
          '_id.month': 1,
          '_id.day': 1
        }
      }
    ]);
  }
}</code></pre>

            <h3>Real-time Chat Application</h3>
            <pre><code>class ChatApplication {
  constructor() {
    this.client = new DBClient('http://localhost:8080');
    this.setupRealTime();
  }
  
  async setupRealTime() {
    // Connect to WebSocket
    await this.client.connectWebSocket();
    
    // Subscribe to messages
    await this.client.subscribe('messages');
    await this.client.subscribe('users');
    
    // Handle real-time events
    this.client.ws.on('message', (data) => {
      const message = JSON.parse(data);
      this.handleRealtimeMessage(message);
    });
  }
  
  async sendMessage(roomId, userId, content) {
    const message = {
      roomId,
      userId, 
      content,
      timestamp: new Date().toISOString(),
      type: 'text'
    };
    
    // Insert via WebSocket for real-time delivery
    return await this.client.wsInsert('messages', message);
  }
  
  async getMessageHistory(roomId, limit = 50) {
    return await this.client.wsFind('messages', {
      roomId: roomId
    }, {
      sort: { timestamp: -1 },
      limit: limit
    });
  }
  
  handleRealtimeMessage(message) {
    switch(message.type) {
      case 'documentInserted':
        if (message.collection === 'messages') {
          this.displayNewMessage(message.document);
        }
        break;
        
      case 'documentUpdated':
        if (message.collection === 'users') {
          this.updateUserStatus(message.document);
        }
        break;
    }
  }
  
  displayNewMessage(message) {
    // Update UI with new message
    console.log('New message:', message);
  }
  
  updateUserStatus(user) {
    // Update user status in UI
    console.log('User updated:', user);
  }
}</code></pre>

            <h3>Command Line Options</h3>
            <pre><code>node bin/server.js \
  --port 8080 \           # Server port
  --host localhost \      # Server host
  --data ./data \         # Data storage path
  --no-cluster \          # Disable clustering
  --workers 4 \           # Number of worker processes
  --max-memory 1024 \     # Max memory in MB
  --no-cache \            # Disable query caching
  --cache-size 1000 \     # Cache size limit
  --no-compression        # Disable compression</code></pre>

            <h3>Environment Variables</h3>
            <pre><code>export DB_PORT=8080
export DB_HOST=localhost
export DB_DATA_PATH=./data
export DB_CLUSTER=true
export DB_WORKERS=4
export DB_MAX_MEMORY=1024
export DB_CACHE=true
export DB_CACHE_SIZE=1000</code></pre>

            <div class="alert">
                <strong>üéâ Congratulations!</strong> You're now ready to build amazing applications with your Node.js database!
            </div>
        </section>
    </div>
</body>
</html>